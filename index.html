<html>
<head>
</head>
<body>
	<button id="toggleSocketConnection" onClick="toggleConnection();">Connect</button>
	<pre id="socketUiOutput"></pre>
	<script src="/socket.io/socket.io.js"></script>
	<script src="/jquery.js"></script>
	<script>
		var connected = false;

		toggleConnection = function() {
			if(connected) {
				window.disconnect();
			} else {
				window.connect();
			}
			setConnected();
		};
		var setConnected = function() {
			var html = connected ? 'Disconnect' : 'Connect';
			$('#toggleSocketConnection').html(html);
		};

		window.connect = function() {
			connected = true;
			console.log('Connecting to socket.io');
			var socket = io.connect('http://localhost');
			socket.on('data', function (obj) {
				$('#socketUiOutput').append(obj.channel + ':' + obj.data + '\n');
			});

			socket.on('error', function(e) {
				console.error(e);
			});
			window.connect = function() {
				connected = true;
				socket.socket.connect();
			};
			window.disconnect = function() {
				connected = false;
				socket.disconnect();
			};
		};
		$('#socketUiOutput').append('Channel:msg\n=======\n');
		toggleConnection();
	</script>
</body>
</html>